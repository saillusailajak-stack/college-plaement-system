<!DOCTYPE html>
<html>
<head>
    <title>Dashboard - Placement System</title>
    <style>
        body { font-family: Arial; margin: 0; padding: 20px; background: #f0f0f0; }
        .header { background: #007bff; color: white; padding: 15px; margin-bottom: 20px; }
        .header a { color: white; text-decoration: none; margin-left: 20px; }
        .stats {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: white; padding: 20px; border-radius: 5px;
            text-align: center; box-shadow: 0 2px 5px #ccc;
        }
        .stat-card h3 { margin: 0; color: #666; }
        .stat-card .number { font-size: 36px; font-weight: bold; color: #007bff; }
        .table-container {
            background: white; padding: 20px; border-radius: 5px;
            box-shadow: 0 2px 5px #ccc;
        }
        table {
            width: 100%; border-collapse: collapse;
        }
        th {
            background: #007bff; color: white; padding: 10px;
            text-align: left;
        }
        td {
            padding: 10px; border-bottom: 1px solid #ddd;
        }
        tr:hover { background: #f5f5f5; }
        .btn {
            padding: 5px 10px; text-decoration: none; border-radius: 3px;
            display: inline-block; margin: 2px;
        }
        .btn-add {
            background: #28a745; color: white; padding: 10px 20px;
            margin-bottom: 20px; display: inline-block;
        }
        .btn-edit { background: #ffc107; color: black; }
        .btn-delete { background: #dc3545; color: white; }
        .btn-update { background: #007bff; color: white; border: none; cursor: pointer; }
        .badge {
            padding: 3px 8px; border-radius: 3px; font-size: 12px;
        }
        .badge-placed { background: #28a745; color: white; }
        .badge-pending { background: #ffc107; color: black; }
        .flash {
            padding: 10px; margin-bottom: 20px; border-radius: 3px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <div class="header">
        <h2 style="display: inline;">College Placement System</h2>
        <a href="{{ url_for('dashboard') }}">Dashboard</a>
        <a href="{{ url_for('add_student') }}">Add Student</a>
        <a href="{{ url_for('logout') }}" style="float: right;">Logout</a>
    </div>

    <div style="max-width: 1200px; margin: auto;">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="flash {{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <!-- Statistics -->
        <div class="stats">
            <div class="stat-card">
                <h3>Total Students</h3>
                <div class="number">{{ total }}</div>
            </div>
            <div class="stat-card">
                <h3>Placed</h3>
                <div class="number" style="color: #28a745;">{{ placed }}</div>
            </div>
            <div class="stat-card">
                <h3>Pending</h3>
                <div class="number" style="color: #ffc107;">{{ pending }}</div>
            </div>
        </div>

        <!-- Add Button -->
        <a href="{{ url_for('add_student') }}" class="btn btn-add">+ Add New Student</a>

        <!-- Students Table -->
        <div class="table-container">
            <h3>Student List</h3>
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Department</th>
                        <th>Target Company</th>
                        <th>Role</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for student in students %}
                    <tr>
                        <td>{{ student.id }}</td>
                        <td>{{ student.name }}</td>
                        <td>{{ student.department }}</td>
                        <td>{{ student.company }}</td>
                        <td>{{ student.role }}</td>
                        <td>
                            <span class="badge {% if student.status == 'Placed' %}badge-placed{% else %}badge-pending{% endif %}">
                                {{ student.status }}
                            </span>
                        </td>
                        <td>
                            <!-- Update Form -->
                            <form method="POST" action="{{ url_for('update_status', student_id=student.id) }}" style="display: inline;">
                                <select name="status" style="padding: 3px;">
                                    <option value="Pending" {% if student.status == 'Pending' %}selected{% endif %}>Pending</option>
                                    <option value="Placed" {% if student.status == 'Placed' %}selected{% endif %}>Placed</option>
                                </select>
                                <button type="submit" class="btn btn-update">Update</button>
                            </form>
                            
                            <!-- Delete Link -->
                            <a href="{{ url_for('delete_student', student_id=student.id) }}" 
                               class="btn btn-delete" 
                               onclick="return confirm('Delete this student?')">Delete</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            
            {% if students|length == 0 %}
            <p style="text-align: center; color: #666;">No students found. Add some!</p>
            {% endif %}
        </div>
    </div>
</body>
</html>